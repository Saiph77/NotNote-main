(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0d9ba75c"],{"0ae28":function(e,t,a){"use strict";var i=a("74ce"),n=a.n(i);n.a},"4ef5":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticStyle:{"padding-bottom":"10px"}},[a("router-link",{staticStyle:{color:"black","text-decoration":"none"},attrs:{to:"/"}},[a("el-button",[e._v("返回")])],1)],1),a("el-tabs",{attrs:{type:"border-card","tab-position":"top"},on:{"tab-click":e.tabClick}},[a("el-tab-pane",{attrs:{label:"🔑 修改密码"}},[a("el-form",{attrs:{"label-width":"110px"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleChangePassword(t)}}},[a("el-form-item",{staticClass:"noselect",attrs:{label:"旧密码"}},[a("el-input",{staticStyle:{"max-width":"500px","margin-right":"20px"},attrs:{type:"password"},model:{value:e.oldPassword,callback:function(t){e.oldPassword=t},expression:"oldPassword"}})],1),a("el-form-item",{staticClass:"noselect",attrs:{label:"新密码"}},[a("el-input",{staticStyle:{"max-width":"500px","margin-right":"20px"},attrs:{type:"password"},model:{value:e.newPassword,callback:function(t){e.newPassword=t},expression:"newPassword"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleChangePassword()}}},[e._v("提交")])],1)],1)],1),a("el-tab-pane",{attrs:{label:"🔄 远程Git仓库"}},[a("el-form",{attrs:{"label-width":"100px"}},[a("el-form-item",{staticClass:"noselect",attrs:{label:"说明"}},[a("div",[e._v("依次完成如下三步，点击开始即可备份至远程仓库")])]),a("el-form-item",{staticClass:"noselect",attrs:{label:"第一步"}},[e._v(" 点击右边按钮 "),a("el-button",{staticClass:"noselect",staticStyle:{"margin-left":"3px"},attrs:{type:"primary"},on:{click:function(t){return e.handleGenSshKey()}}},[e._v("生成ssh密钥")]),e.genSshKey?a("div",[a("p",{staticStyle:{"margin-top":"0px","margin-bottom":"0px"}},[e._v("生成的ssh公钥")]),a("el-input",{staticStyle:{"max-width":"500px","margin-right":"20px","padding-top":"0",color:"grey"},attrs:{type:"textarea",readonly:!0,autosize:""},model:{value:e.sshkey,callback:function(t){e.sshkey=t},expression:"sshkey"}})],1):e._e()],1),a("el-form-item",{staticClass:"noselect",attrs:{label:"第二步"}},[e._v(" 将生成的ssh公钥粘贴至远程仓库合适位置 ")]),a("el-form-item",{staticClass:"noselect",attrs:{label:"第三步"}},[e._v(" 输入Git远程仓库地址，例如 git@github.com:Hansanshi/mark-idea-front.git, 并点击提交保存。（点击开始备份即可开始） "),a("br"),a("el-input",{staticStyle:{"max-width":"500px","margin-right":"20px"},attrs:{placeholder:"e.g. git@github.com:Hansanshi/mark-idea-front.git"},model:{value:e.remoteRepoUrl,callback:function(t){e.remoteRepoUrl=t},expression:"remoteRepoUrl"}}),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleSetRemoteRepo()}}},[e._v("提交")])],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleStartPush()}}},[e._v("开始备份至远程Git库")]),a("el-button",{on:{click:function(t){return e.handleStopPush()}}},[e._v("停止")])],1)],1)],1),a("el-tab-pane",{attrs:{label:"🗂️ 文件管理"}},[a("file-manage")],1),a("el-tab-pane",{attrs:{label:"📑 公开笔记管理"}},[a("public-note-manage")],1),a("el-tab-pane",{attrs:{label:"🖼️ 编辑器设置",mname:"editorConfigTab"}},[a("editor-setting",{ref:"editorSetting"})],1)],1)],1)},n=[],l=a("bc3a"),o=a.n(l),s=a("2919"),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("input",{ref:"fileUpload",staticStyle:{display:"none"},attrs:{type:"file"},on:{change:function(t){return e.handleFileUpload(t)}}}),a("div",[a("el-button",{on:{click:e.tirggerFileUpload}},[e._v("上传")]),a("el-button",{on:{click:e.handleDeleteSelectedFile}},[e._v("删除")])],1),a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,"tooltip-effect":"dark"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),a("el-table-column",{attrs:{label:"文件名",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.fileName))]}}])}),a("el-table-column",{attrs:{prop:"fileSize",label:"大小",width:"120"}}),a("el-table-column",{attrs:{prop:"lastModifiedTime",label:"修改时间",width:"200","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("a",{staticStyle:{"padding-right":"10px"},attrs:{href:"/file/"+e.config.headers.username+"/"+t.row.fileName,target:"_blank"}},[e._v("预览")]),a("el-button",{attrs:{type:"text",size:"medium"},on:{click:function(a){return e.handleDeleteFile(t.row.fileName)}}},[e._v("删除")])]}}])})],1),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{background:"","current-page":e.pageIndex,"page-sizes":[10,50,100],"page-size":e.pageSize,layout:" prev, pager, next, jumper, sizes, total",total:e.totalSize},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)},c=[],d={data:function(){return{config:{headers:{token:this.$store.getters.getToken,username:this.$store.getters.getUsername}},tableData:[{fileName:"玉米.md",fileSize:"134 GB",lastModifiedTime:"2020-09-24 56:78"},{fileName:"yuyu.md",fileSize:"132 GB",lastModifiedTime:"2020-09-24 56:78"}],selectedFiles:[],pageSize:10,pageIndex:1,totalSize:0}},methods:{tirggerFileUpload:function(){this.$refs.fileUpload.click()},handleSelectionChange:function(e){this.selectedFiles=e},handleSizeChange:function(e){this.loadUserFiles(this.pageIndex,e)},handleCurrentChange:function(e){this.loadUserFiles(e,this.pageSize)},loadUserFiles:function(e,t){var a=this,i=s["a"].HOST_URL+"/file?pageIndex="+e+"&pageSize="+t;o.a.get(i,this.config).then((function(e){e=e.data,0==e.code&&(a.tableData=e.data.fileDetailList,a.pageIndex=e.data.pageIndex,a.pageSize=e.data.pageSize,a.totalSize=e.data.totalSize)}))},handleDeleteSelectedFile:function(){for(var e=[],t=0;t<this.selectedFiles.length;t++){var a=this.selectedFiles[t];e.push(a.fileName)}this.handleBatchDeleteFile(e)},handleDeleteFile:function(e){var t=[];t.push(e),this.handleBatchDeleteFile(t)},handleBatchDeleteFile:function(e){var t=this,a=s["a"].HOST_URL+"/file/delete/batch",i={fileNames:e};0!=i.fileNames.length&&o.a.post(a,i,this.config).then((function(e){e=e.data,0===e.code&&t.loadUserFiles(1,t.pageSize)}))},handleFileUpload:function(){var e=this,t=event.target.files[0],a=new FormData;a.append("file",t);var i={headers:{"Content-Type":"multipart/form-data",token:this.config.headers.token,username:this.config.headers.username}},n=s["a"].HOST_URL+"/file";o.a.post(n,a,i).then((function(t){t=t.data,0===t.code&&e.loadUserFiles(e.pageIndex,e.pageSize)}))}},mounted:function(){this.loadUserFiles(this.pageIndex,this.pageSize)}},u=d,h=(a("da91"),a("2877")),f=Object(h["a"])(u,r,c,!1,null,"9065f12c",null),g=f.exports,p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",[a("el-button",{on:{click:e.handleDelArticles}},[e._v("删除")])],1),a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,"tooltip-effect":"dark"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),a("el-table-column",{attrs:{label:"公开笔记id",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.articleId))]}}])}),a("el-table-column",{attrs:{prop:"notebookName",label:"笔记本名",width:"120"}}),a("el-table-column",{attrs:{prop:"noteTitle",label:"标题",width:"200","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("a",{staticStyle:{"padding-right":"10px"},attrs:{href:"/#/article/"+e.config.headers.username+"/"+t.row.articleId,target:"_blank"}},[e._v("预览")])]}}])})],1),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{background:"","current-page":e.pageIndex,"page-sizes":[10,50,100],"page-size":e.pageSize,layout:" prev, pager, next, jumper, sizes, total",total:e.totalSize},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)},m=[],b={data:function(){return{config:{headers:{token:this.$store.getters.getToken,username:this.$store.getters.getUsername}},tableData:[],selectedArticles:[],pageSize:10,pageIndex:1,totalSize:0}},methods:{handleDelArticles:function(){var e=this;console.log("handleDelArticles");var t={articleList:this.selectedArticles};console.log(t),o.a.post(s["a"].HOST_URL+"/article/batchDel",t,this.config).then((function(t){t=t.data,console.log(t),0===t.code&&e.listUserArticls(1,e.pageSize)}))},handleSelectionChange:function(e){this.selectedArticles=e},handleSizeChange:function(e){this.listUserArticls(this.pageIndex,e)},handleCurrentChange:function(e){this.listUserArticls(e,this.pageSize)},listUserArticls:function(e,t){var a=this;o.a.get(s["a"].HOST_URL+"/article",{headers:this.config.headers,params:{page:e-1,size:t}}).then((function(e){e=e.data,0===e.code&&(e=e.data,a.tableData=e.content,a.totalSize=e.totalElements,a.pageIndex=e.number+1,a.pageSize=e.size)}))},handleDeleteSelectedArticles:function(){}},mounted:function(){this.listUserArticls(this.pageIndex,this.pageSize)}},v=b,y=(a("a18b"),Object(h["a"])(v,p,m,!1,null,"7be14520",null)),S=y.exports,C=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"form",attrs:{"label-width":"140px"}},[a("el-form-item",{attrs:{label:"默认编辑模式"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.editorConfig.editMode,callback:function(t){e.$set(e.editorConfig,"editMode",t)},expression:"editorConfig.editMode"}},e._l(e.editModeOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"是否统计字数"}},[a("el-switch",{attrs:{"active-color":e.switchActiveColor,"inactive-color":e.switchInactiveColor,"active-value":!0,"inactive-value":!1},model:{value:e.editorConfig.enableCounter,callback:function(t){e.$set(e.editorConfig,"enableCounter",t)},expression:"editorConfig.enableCounter"}})],1),a("el-form-item",{attrs:{label:"是否启用代码高亮"}},[a("el-switch",{attrs:{"active-color":e.switchActiveColor,"inactive-color":e.switchInactiveColor,"active-value":!0,"inactive-value":!1},model:{value:e.editorConfig.enableHighLight,callback:function(t){e.$set(e.editorConfig,"enableHighLight",t)},expression:"editorConfig.enableHighLight"}})],1),e.editorConfig.enableHighLight?a("el-form-item",{attrs:{label:"代码样式"}},[a("el-input",{staticStyle:{"max-width":"100px"},attrs:{clearable:""},model:{value:e.editorConfig.codeStyle,callback:function(t){e.$set(e.editorConfig,"codeStyle",t)},expression:"editorConfig.codeStyle"}}),a("el-link",{staticStyle:{"padding-left":"5px"},attrs:{underline:!1,href:"https://xyproto.github.io/splash/docs/longer/all.html",target:"_blank"}},[e._v("样式参考")])],1):e._e(),a("el-form-item",{attrs:{label:"是否启用代码行号"}},[a("el-switch",{attrs:{"active-color":e.switchActiveColor,"inactive-color":e.switchInactiveColor,"active-value":!0,"inactive-value":!1},model:{value:e.editorConfig.enableLineNumber,callback:function(t){e.$set(e.editorConfig,"enableLineNumber",t)},expression:"editorConfig.enableLineNumber"}})],1),a("el-form-item",{attrs:{label:"是否默认开启大纲"}},[a("el-switch",{attrs:{"active-color":e.switchActiveColor,"inactive-color":e.switchInactiveColor,"active-value":!0,"inactive-value":!1},model:{value:e.editorConfig.enableOutline,callback:function(t){e.$set(e.editorConfig,"enableOutline",t)},expression:"editorConfig.enableOutline"}})],1),a("el-form-item",{attrs:{label:"大纲位置"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.editorConfig.outlinePosition,callback:function(t){e.$set(e.editorConfig,"outlinePosition",t)},expression:"editorConfig.outlinePosition"}},e._l(e.outlinePositionOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"自定义编辑器样式"}},[a("el-switch",{attrs:{"active-color":e.switchActiveColor,"inactive-color":e.switchInactiveColor,"active-value":!0,"inactive-value":!1},model:{value:e.editorConfig.enableCustomStyle,callback:function(t){e.$set(e.editorConfig,"enableCustomStyle",t)},expression:"editorConfig.enableCustomStyle"}})],1),e.editorConfig.enableCustomStyle?a("el-form-item",{attrs:{label:"编辑器样式路径"}},[a("el-input",{staticStyle:{"max-width":"280px","padding-right":"5px"},attrs:{clearable:""},model:{value:e.editorConfig.customStylePath,callback:function(t){e.$set(e.editorConfig,"customStylePath",t)},expression:"editorConfig.customStylePath"}}),a("el-button",{attrs:{type:"mini"},on:{click:e.tirggerFileUpload}},[e._v("导入")]),a("input",{ref:"fileUpload",staticStyle:{display:"none"},attrs:{type:"file"},on:{change:function(t){return e.handleFileUpload(t)}}}),a("el-link",{staticStyle:{"padding-left":"5px"},attrs:{underline:!1,href:"https://github.com/Hansanshi/mark-idea-front/blob/main/src/assets/vditor.css",target:"_blank"}},[e._v("样式参考")])],1):e._e(),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.handleSaveEditorConfig}},[e._v("保存")])],1)],1)],1)},w=[],k={data:function(){return{config:{headers:{token:this.$store.getters.getToken,username:this.$store.getters.getUsername}},switchActiveColor:getComputedStyle(document.body).getPropertyValue("--switch-active-color"),switchInactiveColor:getComputedStyle(document.body).getPropertyValue("--switch-inactive-color"),editModeOptions:[{value:"ir",label:"即时渲染"},{value:"wysiwyg",label:"所见即所得"},{value:"sv",label:"分屏预览"}],outlinePositionOptions:[{value:"left",label:"左侧"},{value:"right",label:"右侧"}],editorConfig:{}}},methods:{handleSaveEditorConfig:function(){var e=this;o.a.post(s["a"].HOST_URL+"/user/updateEditorConfig",this.editorConfig,this.config).then((function(t){t=t.data,0===t.code?(e.editorConfig=t.data,e.$store.commit("setEditorConfig",t.data),e.$notify({type:"success",message:"更新配置成功",duration:2e3})):e.$notify({type:"warning",message:"更新配置失败",duration:2e3})}))},loadEditorConfig:function(){var e=this;o.a.get(s["a"].HOST_URL+"/user/editorConfig",this.config).then((function(t){t=t.data,0===t.code?e.editorConfig=t.data:e.$notify({type:"warning",message:"加载配置失败",duration:2e3})}))},tirggerFileUpload:function(){this.$refs.fileUpload.click()},handleFileUpload:function(){var e=this,t=event.target.files[0],a=new FormData;a.append("file",t);var i={headers:{"Content-Type":"multipart/form-data",token:this.config.headers.token,username:this.config.headers.username}},n=s["a"].HOST_URL+"/file";o.a.post(n,a,i).then((function(t){t=t.data,0===t.code&&(e.editorConfig.customStylePath=t.data)}))}}},x=k,_=Object(h["a"])(x,C,w,!1,null,null,null),U=_.exports,z={name:"admin",components:{FileManage:g,PublicNoteManage:S,EditorSetting:U},data:function(){return{gitActive:0,genSshKey:!1,sshkey:"",remoteRepoUrl:null,oldPassword:null,newPassword:null,config:{headers:{token:this.$store.getters.getToken,username:this.$store.getters.getUsername}}}},methods:{handleStartPush:function(){var e=this,t=s["a"].HOST_URL+"/user/push";o.a.post(t,null,this.config).then((function(t){t=t.data,0===t.code&&e.$notify({type:"success",message:"开始备份至远程仓库",duration:1e3})}))},handleStopPush:function(){var e=this,t=s["a"].HOST_URL+"/user/push";o.a.delete(t,this.config).then((function(t){t=t.data,0===t.code&&e.$notify({type:"success",message:"停止备份",duration:1e3})}))},handleSetRemoteRepo:function(){var e=this,t={remoteRepoUrl:this.remoteRepoUrl},a=s["a"].HOST_URL+"/user/remote";o.a.put(a,t,this.config).then((function(t){t=t.data,0===t.code&&e.$notify({type:"success",message:"设置远程仓库成功"})}))},handleGenSshKey:function(){var e=this;this.genSshKey=!1;var t=s["a"].HOST_URL+"/user/sshkey";o.a.post(t,null,this.config).then((function(t){t=t.data,0===t.code&&(e.sshkey=t.data,e.genSshKey=!0)}))},notifyLoadEditorConfig:function(){console.log("fdsfsdfsdfsf"),this.$refs.editorSetting.loadEditorConfig()},tabClick:function(e){"editorConfigTab"===e.$attrs.mname&&this.notifyLoadEditorConfig()},handleChangePassword:function(){var e=this,t=s["a"].HOST_URL+"/user/changePass",a={password:this.oldPassword,newPassword:this.newPassword};o.a.post(t,a,this.config).then((function(t){t=t.data,0===t.code?(e.$notify({type:"success",message:"修改密码成功"}),e.newPassword=null,e.oldPassword=null):e.$notify({type:"warning",message:t.msg})}))}},mounted:function(){var e=this;if(document.title=this.$store.getters.getWebsiteTitle+" - 设置",!this.config.headers.token)return this.$notify({type:"warning",message:"需要登录"}),void setTimeout((function(){e.$router.push("/login")}),700);var t=s["a"].HOST_URL+"/user/validate";o.a.post(t,null,this.config).then((function(t){t=t.data,0!==t.code&&(e.$store.commit("setLocalInfo",{}),e.$notify({type:"warning",message:"需要登录",duration:1500}),setTimeout((function(){e.$router.push("/login")}),700))}));var a=s["a"].HOST_URL+"/user/remote";o.a.get(a,this.config).then((function(t){t=t.data,0===t.code&&(e.remoteRepoUrl=t.data)}))}},$=z,P=(a("0ae28"),Object(h["a"])($,i,n,!1,null,null,null));t["default"]=P.exports},"74ce":function(e,t,a){},"76be":function(e,t,a){},a18b:function(e,t,a){"use strict";var i=a("76be"),n=a.n(i);n.a},a9c6:function(e,t,a){},da91:function(e,t,a){"use strict";var i=a("a9c6"),n=a.n(i);n.a}}]);
//# sourceMappingURL=chunk-0d9ba75c.7606b23a.js.map